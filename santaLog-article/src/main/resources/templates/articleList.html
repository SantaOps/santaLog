<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>ë¸”ë¡œê·¸ ê¸€ ëª©ë¡</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        .thumbnail-wrapper { width: 100%; height: 180px; overflow: hidden; }
        .thumbnail-wrapper img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
        .card:hover .thumbnail-wrapper img { transform: scale(1.05); }
        .card:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.15); transform: translateY(-5px); transition: all 0.3s ease; }
        .notice-banner-section { background: linear-gradient(to bottom, #8b0000 0%, rgba(255,255,255,0) 60%); padding: 40px 0 60px 0; margin-bottom: 20px; border-radius: 0 0 30px 30px; position: relative; }
        .section-title { color: #fff; margin-bottom: 30px; font-weight: 800; border-left: 6px solid #ff4d4d; padding-left: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .notice-card { border-radius: 20px !important; overflow: hidden; border: none; box-shadow: 0 5px 15px rgba(0,0,0,0.1) !important; }
        .carousel-control-prev, .carousel-control-next { width: 45px; height: 45px; background-color: #000; border-radius: 50%; top: 50%; transform: translateY(-50%); opacity: 0.8; z-index: 10; color: #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: all 0.3s ease; }
        .carousel-control-prev { left: -25px; }
        .carousel-control-next { right: -25px; }
        .carousel-control-prev:hover, .carousel-control-next:hover { background-color: #333; opacity: 1; transform: translateY(-50%) scale(1.1); }
        .list-thumbnail { width: 200px; height: 150px; overflow: hidden; flex-shrink: 0; }
        .list-thumbnail img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>
<div class="bg-white border-bottom shadow-sm">
    <div class="container p-3 d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
            <a href="/articles" class="mr-3">
                <img th:src="${IMG_PATH + 'logo.png'}" alt="Logo" style="height: 50px;">
            </a>
            <h1 class="mb-1 font-weight-bold">
                SantaLog
                <span sec:authorize="hasRole('ADMIN')" style="font-size: 0.6em;">- ê´€ë¦¬ì í˜ì´ì§€</span>
            </h1>
        </div>
        <div class="d-flex align-items-center">
            <button sec:authorize="hasRole('ADMIN')"
                    type="button"
                    class="btn btn-outline-dark btn-sm mr-2"
                    onclick="location.href='/admin/stats'">
                <i class="fas fa-chart-bar"></i> í†µê³„ í™•ì¸
            </button>
            <button type="button" class="btn btn-outline-danger btn-sm"
                    onclick="location.href='https://santalog.cloud:31443/logout'">
                <i class="fas fa-sign-out-alt"></i> ë¡œê·¸ì•„ì›ƒ
            </button>
        </div>
    </div>
</div>

<!-- ê³µì§€ì‚¬í•­ ë°°ë„ˆ -->
<div class="notice-banner-section" th:if="${!noticeChunks.isEmpty()}">
    <div class="container position-relative">
        <h4 class="section-title">ğŸ“¢ ì£¼ìš” ê³µì§€ì‚¬í•­</h4>

        <div id="noticeCarousel" class="carousel slide" data-ride="carousel" data-interval="5000">
            <div class="carousel-inner">
                <div th:each="chunk, status : ${noticeChunks}"
                     class="carousel-item"
                     th:classappend="${status.first} ? 'active'">
                    <div class="row">
                        <div class="col-md-4" th:each="notice : ${chunk}">
                            <div class="card h-100 notice-card"
                                 th:onclick="|location.href='/articles/' + ${notice.id}|"
                                 style="cursor: pointer;">
                                <div class="thumbnail-wrapper">
                                    <img th:src="${notice.thumbnailUrl != null} ?
                                                 (${#strings.startsWith(notice.thumbnailUrl, 'http')} ? notice.thumbnailUrl : IMG_PATH + notice.thumbnailUrl)
                                                 : IMG_PATH + 'default.png'"
                                         class="card-img-top" alt="thumbnail">
                                </div>
                                <div class="card-body">
                                    <span class="badge badge-danger mb-2">Notice</span>
                                    <h5 class="card-title text-truncate" th:text="${notice.title}">ì œëª©</h5>
                                    <p class="card-text text-muted small text-truncate" th:text="${notice.content}">ë‚´ìš©...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <a th:if="${noticeChunks.size() > 1}" class="carousel-control-prev" href="#noticeCarousel" role="button" data-slide="prev">
                <i class="fas fa-chevron-left"></i>
                <span class="sr-only">Previous</span>
            </a>
            <a th:if="${noticeChunks.size() > 1}" class="carousel-control-next" href="#noticeCarousel" role="button" data-slide="next">
                <i class="fas fa-chevron-right"></i>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>

<!-- ìµœì‹  ê¸€ -->
<div class="container" style="margin-top: 80px;">
    <div class="d-flex justify-content-between align-items-end mb-4">
        <h4 class="font-weight-bold mb-0" style="color: #333; border-left: 5px solid #8b0000; padding-left: 15px; line-height: 1;">
            ìµœì‹  ê¸€ <span style="font-size: 0.6em; color: #888; font-weight: normal; margin-left: 10px;">New Articles</span>
        </h4>

        <button type="button" id="create-btn" th:onclick="|location.href='/new-article'|" class="btn btn-danger btn-sm shadow-sm">
            <i class="fas fa-pen"></i> ê¸€ ì“°ê¸°
        </button>
    </div>

    <div class="list-group">
        <div th:each="item : ${articles}"
             class="card mb-3 shadow-sm"
             th:onclick="|location.href='/articles/' + ${item.id}|"
             style="cursor: pointer; transition: 0.2s;">
            <div class="d-flex flex-row">
                <div class="list-thumbnail">
                    <img th:src="${item.thumbnailUrl != null} ?
                                 (${#strings.startsWith(item.thumbnailUrl, 'http')} ? item.thumbnailUrl : IMG_PATH + item.thumbnailUrl)
                                 : IMG_PATH + 'default.png'" alt="thumbnail">
                </div>
                <div class="card-body">
                    <span th:if="${item.isWarned}" class="badge badge-warning text-dark mb-1">ğŸš« ì£¼ì˜í•  ê²Œì‹œê¸€</span>
                    <h5 class="card-title font-weight-bold" th:text="${item.title}"></h5>
                    <p class="card-text text-muted" th:text="${item.content}"
                       style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="/js/article.js"></script>
</body>
</html>
